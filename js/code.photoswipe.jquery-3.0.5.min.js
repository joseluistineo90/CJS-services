!function(t){Function.prototype.bind||(Function.prototype.bind=function(t){var e=[].slice,i=e.call(arguments,1),s=this,o=function(){},n=function(){return s.apply(this instanceof o?this:t||{},i.concat(e.call(arguments)))};return o.prototype=s.prototype,n.prototype=new o,n}),"undefined"==typeof t.Code&&(t.Code={}),t.Code.Util={registerNamespace:function(){var e,i,s,o,n,a,r,h=arguments,l=null;for(e=0,a=h.length;a>e;e++)for(s=h[e],o=s.split("."),n=o[0],"undefined"==typeof t[n]&&(t[n]={}),l=t[n],i=1,r=o.length;r>i;++i)l[o[i]]=l[o[i]]||{},l=l[o[i]]},coalesce:function(){var t,e;for(t=0,e=arguments.length;e>t;t++)if(!this.isNothing(arguments[t]))return arguments[t];return null},extend:function(t,e,i){var s;if(this.isNothing(i)&&(i=!0),t&&e&&this.isObject(e))for(s in e)this.objectHasProperty(e,s)&&(i?t[s]=e[s]:"undefined"==typeof t[s]&&(t[s]=e[s]))},clone:function(t){var e={};return this.extend(e,t),e},isObject:function(t){return t instanceof Object},isFunction:function(t){return"[object Function]"==={}.toString.call(t)},isArray:function(t){return t instanceof Array},isLikeArray:function(t){return"number"==typeof t.length},isNumber:function(t){return"number"==typeof t},isString:function(t){return"string"==typeof t},isNothing:function(t){return"undefined"==typeof t||null===t},swapArrayElements:function(t,e,i){var s=t[e];t[e]=t[i],t[i]=s},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})},toDashedCase:function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},arrayIndexOf:function(t,e,i){var s,o,n,a;for(n=-1,s=0,o=e.length;o>s;s++)if(a=e[s],this.isNothing(i)){if(a===t){n=s;break}}else if(this.objectHasProperty(a,i)&&a[i]===t){n=s;break}return n},objectHasProperty:function(t,e){return t.hasOwnProperty?t.hasOwnProperty(e):"undefined"!=typeof t[e]}}}(window),function(t,e){e.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=t.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(t.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(t.navigator.platform),this.iPad=/ipad/gi.test(t.navigator.platform),this.iPhone=/iphone/gi.test(t.navigator.platform),this.iPod=/ipod/gi.test(t.navigator.platform);var i=document.createElement("div");this.is3dSupported=!e.isNothing(i.style.WebkitPerspective),this.isCSSTransformSupported=!e.isNothing(i.style.WebkitTransform)||!e.isNothing(i.style.MozTransform)||!e.isNothing(i.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(t){var i,s=document.createElement(this._eventTagNames[t]||"div");return t="on"+t,i=e.objectHasProperty(s,t),i||(s.setAttribute(t,"return;"),i="function"==typeof s[t]),s=null,i},isLandscape:function(){return e.DOM.windowWidth()>e.DOM.windowHeight()}},e.Browser._detect()}(window,window.Code.Util),function(t,e,i){i.extend(i,{Events:{add:function(t,i,s){e(t).bind(i,s)},remove:function(t,i,s){e(t).unbind(i,s)},fire:function(t,i){var s,o=Array.prototype.slice.call(arguments).splice(2);s="string"==typeof i?{type:i}:i,e(t).trigger(e.Event(s.type,s),o)},getMousePosition:function(t){var e={x:t.pageX,y:t.pageY};return e},getTouchEvent:function(t){return t.originalEvent},getWheelDelta:function(t){var e=0;return i.isNothing(t.wheelDelta)?i.isNothing(t.detail)||(e=-t.detail/3):e=t.wheelDelta/120,e},domReady:function(t){e(document).ready(t)}}})}(window,window.jQuery,window.Code.Util),function(t,e,i){i.extend(i,{DOM:{setData:function(t,e,s){if(i.isLikeArray(t)){var o,n;for(o=0,n=t.length;n>o;o++)i.DOM._setData(t[o],e,s)}else i.DOM._setData(t,e,s)},_setData:function(t,e,s){i.DOM.setAttribute(t,"data-"+e,s)},getData:function(t,e,s){return i.DOM.getAttribute(t,"data-"+e,s)},removeData:function(t,e){if(i.isLikeArray(t)){var s,o;for(s=0,o=t.length;o>s;s++)i.DOM._removeData(t[s],e)}else i.DOM._removeData(t,e)},_removeData:function(t,e){i.DOM.removeAttribute(t,"data-"+e)},isChildOf:function(t,e){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},find:function(s,o){i.isNothing(o)&&(o=t.document);var n,a,r=e(s,o),h=[];for(n=0,a=r.length;a>n;n++)h.push(r[n]);return h},createElement:function(t,i,s){var o=e("<"+t+"></"+t+">");return o.attr(i),o.append(s),o[0]},appendChild:function(t,i){e(i).append(t)},insertBefore:function(t,i){e(t).insertBefore(i)},appendText:function(t,i){e(i).text(t)},appendToBody:function(t){e("body").append(t)},removeChild:function(t){e(t).empty().remove()},removeChildren:function(t){e(t).empty()},hasAttribute:function(t,s){return!i.isNothing(e(t).attr(s))},getAttribute:function(t,s,o){var n=e(t).attr(s);return i.isNothing(n)&&!i.isNothing(o)&&(n=o),n},setAttribute:function(t,e,s){if(i.isLikeArray(t)){var o,n;for(o=0,n=t.length;n>o;o++)i.DOM._setAttribute(t[o],e,s)}else i.DOM._setAttribute(t,e,s)},_setAttribute:function(t,i,s){e(t).attr(i,s)},removeAttribute:function(t,e){if(i.isLikeArray(t)){var s,o;for(s=0,o=t.length;o>s;s++)i.DOM._removeAttribute(t[s],e)}else i.DOM._removeAttribute(t,e)},_removeAttribute:function(t,i){e(t).removeAttr(i)},addClass:function(t,e){if(i.isLikeArray(t)){var s,o;for(s=0,o=t.length;o>s;s++)i.DOM._addClass(t[s],e)}else i.DOM._addClass(t,e)},_addClass:function(t,i){e(t).addClass(i)},removeClass:function(t,e){if(i.isLikeArray(t)){var s,o;for(s=0,o=t.length;o>s;s++)i.DOM._removeClass(t[s],e)}else i.DOM._removeClass(t,e)},_removeClass:function(t,i){e(t).removeClass(i)},hasClass:function(t,i){e(t).hasClass(i)},setStyle:function(t,e,s){if(i.isLikeArray(t)){var o,n;for(o=0,n=t.length;n>o;o++)i.DOM._setStyle(t[o],e,s)}else i.DOM._setStyle(t,e,s)},_setStyle:function(t,s,o){var n;if(i.isObject(s))for(n in s)i.objectHasProperty(s,n)&&("width"===n?i.DOM.width(t,s[n]):"height"===n?i.DOM.height(t,s[n]):e(t).css(n,s[n]));else e(t).css(s,o)},getStyle:function(t,i){return e(t).css(i)},hide:function(t){if(i.isLikeArray(t)){var e,s;for(e=0,s=t.length;s>e;e++)i.DOM._hide(t[e])}else i.DOM._hide(t)},_hide:function(t){e(t).hide()},show:function(t){if(i.isLikeArray(t)){var e,s;for(e=0,s=t.length;s>e;e++)i.DOM._show(t[e])}else i.DOM._show(t)},_show:function(t){e(t).show()},width:function(t,s){return i.isNothing(s)||e(t).width(s),e(t).width()},outerWidth:function(t){return e(t).outerWidth()},height:function(t,s){return i.isNothing(s)||e(t).height(s),e(t).height()},outerHeight:function(t){return e(t).outerHeight()},documentWidth:function(){return e(document.documentElement).width()},documentHeight:function(){return e(document.documentElement).height()},documentOuterWidth:function(){return i.DOM.width(document.documentElement)},documentOuterHeight:function(){return i.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return e(document.body).width()},bodyHeight:function(){return e(document.body).height()},bodyOuterWidth:function(){return i.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return i.DOM.outerHeight(document.body)},windowWidth:function(){return t.innerWidth?t.innerWidth:e(t).width()},windowHeight:function(){return t.innerHeight?t.innerHeight:e(t).height()},windowScrollLeft:function(){return t.pageXOffset?t.pageXOffset:e(t).scrollLeft()},windowScrollTop:function(){return t.pageYOffset?t.pageYOffset:e(t).scrollTop()}}})}(window,window.jQuery,window.Code.Util),function(t,e){e.extend(e,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:void 0!==t.document.documentElement.style.webkitTransition?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:void 0!==t.document.documentElement.style.webkitTransition?"webkitTransition":void 0!==t.document.documentElement.style.MozTransition?"MozTransition":"transition",_transformLabel:void 0!==t.document.documentElement.style.webkitTransform?"webkitTransform":void 0!==t.document.documentElement.style.MozTransition?"MozTransform":"transform",_getTransitionEndHandler:function(){return e.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(i){if(e.Browser.isCSSTransformSupported){var s=(i.style[this._transitionPrefix+"Property"],{});e.Events.remove(i,this._transitionEndLabel,this._getTransitionEndHandler()),e.isNothing(i.callbackLabel)&&delete i.callbackLabel,s[this._transitionPrefix+"Property"]="",s[this._transitionPrefix+"Duration"]="",s[this._transitionPrefix+"TimingFunction"]="",s[this._transitionPrefix+"Delay"]="",s[this._transformLabel]="",e.DOM.setStyle(i,s)}else e.isNothing(t.jQuery)||t.jQuery(i).stop(!0,!0)},fadeIn:function(i,s,o,n,a){if(a=e.coalesce(a,1),0>=a&&(a=1),0>=s&&(e.DOM.setStyle(i,"opacity",a),!e.isNothing(o)))return void o(i);var r=e.DOM.getStyle(i,"opacity");r>=1&&e.DOM.setStyle(i,"opacity",0),e.Browser.isCSSTransformSupported?this._applyTransition(i,"opacity",a,s,o,n):e.isNothing(t.jQuery)||t.jQuery(i).fadeTo(s,a,o)},fadeTo:function(t,e,i,s,o){this.fadeIn(t,i,s,o,e)},fadeOut:function(i,s,o,n){return 0>=s&&(e.DOM.setStyle(i,"opacity",0),!e.isNothing(o))?void o(i):void(e.Browser.isCSSTransformSupported?this._applyTransition(i,"opacity",0,s,o,n):t.jQuery(i).fadeTo(s,0,o))},slideBy:function(i,s,o,n,a,r){var h={};s=e.coalesce(s,0),o=e.coalesce(o,0),r=e.coalesce(r,"ease-out"),h[this._transitionPrefix+"Property"]="all",h[this._transitionPrefix+"Delay"]="0",0===n?(h[this._transitionPrefix+"Duration"]="",h[this._transitionPrefix+"TimingFunction"]=""):(h[this._transitionPrefix+"Duration"]=n+"ms",h[this._transitionPrefix+"TimingFunction"]=e.coalesce(r,"ease-out"),e.Events.add(i,this._transitionEndLabel,this._getTransitionEndHandler())),h[this._transformLabel]=e.Browser.is3dSupported?"translate3d("+s+"px, "+o+"px, 0px)":"translate("+s+"px, "+o+"px)",e.isNothing(a)||(i.cclallcallback=a),e.DOM.setStyle(i,h),0===n&&t.setTimeout(function(){this._leaveTransforms(i)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(t){var i={};i[this._transformLabel]=i[this._transformLabel]=e.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",e.DOM.setStyle(t,i)},_applyTransition:function(i,s,o,n,a,r){var h={};r=e.coalesce(r,"ease-in"),h[this._transitionPrefix+"Property"]=s,h[this._transitionPrefix+"Duration"]=n+"ms",h[this._transitionPrefix+"TimingFunction"]=r,h[this._transitionPrefix+"Delay"]="0",e.Events.add(i,this._transitionEndLabel,this._getTransitionEndHandler()),e.DOM.setStyle(i,h),e.isNothing(a)||(i["ccl"+s+"callback"]=a),t.setTimeout(function(){e.DOM.setStyle(i,s,o)},this._applyTransitionDelay)},_onTransitionEnd:function(t){e.Events.remove(t.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(t.currentTarget)},_leaveTransforms:function(i){var s,o,n,a,r,h=i.style[this._transitionPrefix+"Property"],l=""!==h?"ccl"+h+"callback":"cclallcallback",d=e.coalesce(i.style.webkitTransform,i.style.MozTransform,i.style.transform),c=t.parseInt(e.DOM.getStyle(i,"left"),0),u=t.parseInt(e.DOM.getStyle(i,"top"),0),g={};""!==d&&(o=e.Browser.is3dSupported?d.match(/translate3d\((.*?)\)/):d.match(/translate\((.*?)\)/),e.isNothing(o)||(n=o[1].split(", "),a=t.parseInt(n[0],0),r=t.parseInt(n[1],0))),g[this._transitionPrefix+"Property"]="",g[this._transitionPrefix+"Duration"]="",g[this._transitionPrefix+"TimingFunction"]="",g[this._transitionPrefix+"Delay"]="",e.DOM.setStyle(i,g),t.setTimeout(function(){e.isNothing(n)||(g={},g[this._transformLabel]="",g.left=c+a+"px",g.top=u+r+"px",e.DOM.setStyle(i,g)),e.isNothing(i[l])||(s=i[l],delete i[l],s(i))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),function(t,e,i){i.registerNamespace("Code.Util.TouchElement"),i.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},i.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.Util.TouchElement"),i.TouchElement.TouchElementClass=e({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var t;this.removeEventHandlers();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){this.el=t,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},i.extend(this.captureSettings,e),this.swipeThreshold=50,this.swipeTimeThreshold=250,this.doubleTapSpeed=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){i.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),i.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&i.Events.add(this.el,"touchmove",this.touchMoveHandler),i.Events.add(this.el,"touchend",this.touchEndHandler),i.Events.add(this.el,"mousedown",this.mouseDownHandler),i.Browser.isGestureSupported&&this.captureSettings.gesture&&(i.Events.add(this.el,"gesturestart",this.gestureStartHandler),i.Events.add(this.el,"gesturechange",this.gestureChangeHandler),i.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){i.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&i.Events.remove(this.el,"touchmove",this.touchMoveHandler),i.Events.remove(this.el,"touchend",this.touchEndHandler),i.Events.remove(this.el,"mousedown",this.mouseDownHandler),i.Browser.isGestureSupported&&this.captureSettings.gesture&&(i.Events.remove(this.el,"gesturestart",this.gestureStartHandler),i.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),i.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(t){return{x:t[0].pageX,y:t[0].pageY}},fireTouchEvent:function(e){var s,o,n=0,a=0,r=0;if(n=this.touchEndPoint.x-this.touchStartPoint.x,a=this.touchEndPoint.y-this.touchStartPoint.y,r=Math.sqrt(n*n+a*a),this.captureSettings.swipe&&(s=new Date,o=s-this.touchStartTime,o<=this.swipeTimeThreshold)){if(t.Math.abs(n)>=this.swipeThreshold)return void i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>n?i.TouchElement.ActionTypes.swipeLeft:i.TouchElement.ActionTypes.swipeRight,targetEl:e.target,currentTargetEl:e.currentTarget});if(t.Math.abs(a)>=this.swipeThreshold)return void i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>a?i.TouchElement.ActionTypes.swipeUp:i.TouchElement.ActionTypes.swipeDown,targetEl:e.target,currentTargetEl:e.currentTarget})}return r>1?void i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget}):this.captureSettings.doubleTap?i.isNothing(this.doubleTapTimeout)?void(this.doubleTapTimeout=t.setTimeout(function(){this.doubleTapTimeout=null,i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.tap,targetEl:e.target,currentTargetEl:e.currentTarget})}.bind(this),this.doubleTapSpeed)):(t.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.doubleTap,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0):void i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.tap,targetEl:e.target,currentTargetEl:e.currentTarget})},onTouchStart:function(t){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),i.Events.remove(this.el,"mousedown",this.mouseDownHandler);var e=i.Events.getTouchEvent(t),s=e.touches;return s.length>1&&this.captureSettings.gesture?void(this.isGesture=!0):(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(s),void i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget}))},onTouchMove:function(t){if(this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),!this.isGesture||!this.captureSettings.gesture){var e=i.Events.getTouchEvent(t),s=e.touches;i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(s),targetEl:t.target,currentTargetEl:t.currentTarget})}},onTouchEnd:function(t){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault();var e=i.Events.getTouchEvent(t),s=i.isNothing(e.changedTouches)?e.touches:e.changedTouches;this.touchEndPoint=this.getTouchPoint(s),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)}},onMouseDown:function(t){t.preventDefault(),i.Events.remove(this.el,"touchstart",this.mouseDownHandler),i.Events.remove(this.el,"touchmove",this.touchMoveHandler),i.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&i.Events.add(this.el,"mousemove",this.mouseMoveHandler),i.Events.add(this.el,"mouseup",this.mouseUpHandler),i.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseMove:function(t){t.preventDefault(),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMove,point:i.Events.getMousePosition(t),targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseUp:function(t){t.preventDefault(),this.captureSettings.move&&i.Events.remove(this.el,"mousemove",this.mouseMoveHandler),i.Events.remove(this.el,"mouseup",this.mouseUpHandler),i.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)},onMouseOut:function(t){var e=t.relatedTarget;this.el===e||i.DOM.isChildOf(e,this.el)||(t.preventDefault(),this.captureSettings.move&&i.Events.remove(this.el,"mousemove",this.mouseMoveHandler),i.Events.remove(this.el,"mouseup",this.mouseUpHandler),i.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t))},onGestureStart:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureStart,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureChange:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureChange,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureEnd:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureEnd,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Image");var s=t.Code.PhotoSwipe;s.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Image");var s=t.Code.PhotoSwipe;s.Image.ImageClass=e({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var t;this.shrinkImage();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,i,s,o){this.refObj=e,this.originalSrc=i,this.src=i,this.caption=s,this.metaData=o,this.imageEl=new t.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){return this.imageEl.originalSrc=i.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc===this.src?void(this.imageEl.isError?i.Events.fire(this,{type:s.Image.EventTypes.onError,target:this}):i.Events.fire(this,{type:s.Image.EventTypes.onLoad,target:this})):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,void(this.imageEl.src=this.src))},shrinkImage:function(){i.isNothing(this.imageEl)||this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",i.isNothing(this.imageEl.parentNode)||i.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null,this.imageEl.naturalWidth=i.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=i.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,i.Events.fire(this,{type:s.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,i.Events.fire(this,{type:s.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Cache");var s=t.Code.PhotoSwipe;s.Cache.Mode={normal:"normal",aggressive:"aggressive"},s.Cache.Functions={getImageSource:function(t){return t.href},getImageCaption:function(t){if("IMG"===t.nodeName)return i.DOM.getAttribute(t,"alt");var e,s,o;for(e=0,s=t.childNodes.length;s>e;e++)if(o=t.childNodes[e],"IMG"===t.childNodes[e].nodeName)return i.DOM.getAttribute(o,"alt")},getImageMetaData:function(){return{}}}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Cache");var s=t.Code.PhotoSwipe;s.Cache.CacheClass=e({images:null,settings:null,dispose:function(){var t,e,s;if(!i.isNothing(this.images)){for(e=0,s=this.images.length;s>e;e++)this.images[e].dispose();this.images.length=0}for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){var i,o,n,a,r,h;for(this.settings=e,this.images=[],i=0,o=t.length;o>i;i++)n=t[i],a=this.settings.getImageSource(n),r=this.settings.getImageCaption(n),h=this.settings.getImageMetaData(n),this.images.push(new s.Image.ImageClass(n,a,r,h))},getImages:function(t){var e,o,n,a=[];for(e=0,o=t.length;o>e;e++)n=this.images[t[e]],this.settings.cacheMode===s.Cache.Mode.aggressive&&(n.cacheDoNotShrink=!0),a.push(n);if(this.settings.cacheMode===s.Cache.Mode.aggressive)for(e=0,o=this.images.length;o>e;e++)n=this.images[e],i.objectHasProperty(n,"cacheDoNotShrink")?delete n.cacheDoNotShrink:n.shrinkImage();return a}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var s=t.Code.PhotoSwipe;s.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var s=t.Code.PhotoSwipe;s.DocumentOverlay.DocumentOverlayClass=e({el:null,settings:null,initialBodyHeight:null,dispose:function(){var t;i.Animation.stop(this.el),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e){this.settings=e,this.el=i.DOM.createElement("div",{"class":s.DocumentOverlay.CssClasses.documentOverlay},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),i.DOM.hide(this.el),this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target),i.Animation.resetTranslate(this.el),this.initialBodyHeight=i.DOM.bodyOuterHeight()},resetPosition:function(){var e,s,o;this.settings.target===t?(e=i.DOM.windowWidth(),s=2*i.DOM.bodyOuterHeight(),o=this.settings.jQueryMobile?i.DOM.windowScrollTop()+"px":"0px",1>s&&(s=this.initialBodyHeight),i.DOM.windowHeight()>s&&(s=i.DOM.windowHeight())):(e=i.DOM.width(this.settings.target),s=i.DOM.height(this.settings.target),o="0px"),i.DOM.setStyle(this.el,{width:e,height:s,top:o})},fadeIn:function(t,e){this.resetPosition(),i.DOM.setStyle(this.el,"opacity",0),i.DOM.show(this.el),i.Animation.fadeIn(this.el,t,e)}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var s=t.Code.PhotoSwipe;s.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},s.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},s.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var s=t.Code.PhotoSwipe;s.Carousel.CarouselClass=e({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var t,e,o;for(e=0,o=this.cache.images.length;o>e;e++)i.Events.remove(this.cache.images[e],s.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(this.cache.images[e],s.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow(),i.Animation.stop(this.el),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o){var n,a,r;for(this.cache=e,this.settings=o,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSliding=!1,this.isSlideshowActive=!1,this.cache.images.length<3&&(this.settings.loop=!1),this.el=i.DOM.createElement("div",{"class":s.Carousel.CssClasses.carousel},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),i.DOM.hide(this.el),this.contentEl=i.DOM.createElement("div",{"class":s.Carousel.CssClasses.content},""),i.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),i.DOM.appendChild(this.contentEl,this.el),a=e.images.length<3?e.images.length:3,n=0;a>n;n++)r=i.DOM.createElement("div",{"class":s.Carousel.CssClasses.item+" "+s.Carousel.CssClasses.item+"-"+n},""),i.DOM.setAttribute(r,"style","float: left;"),i.DOM.setStyle(r,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&i.DOM.setStyle(r,{marginRight:this.settings.margin+"px"}),i.DOM.appendChild(r,this.contentEl);this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var e,o,n,a,r,h,l,d,c,u;for(this.settings.target===t?(e=i.DOM.windowWidth(),o=i.DOM.windowHeight(),n=i.DOM.windowScrollTop()+"px"):(e=i.DOM.width(this.settings.target),o=i.DOM.height(this.settings.target),n="0px"),a=this.settings.margin>0?e+this.settings.margin:e,r=i.DOM.find("."+s.Carousel.CssClasses.item,this.contentEl),h=a*r.length,i.DOM.setStyle(this.el,{top:n,width:e,height:o}),i.DOM.setStyle(this.contentEl,{width:h,height:o}),l=0,d=r.length;d>l;l++)c=r[l],i.DOM.setStyle(c,{width:e,height:o}),u=i.DOM.find("img",c)[0],i.isNothing(u)||this.resetImagePosition(u);this.setContentLeftPosition()},resetImagePosition:function(t){if(!i.isNothing(t)){var e,s,o,n,a,r=(i.DOM.getAttribute(t,"src"),i.DOM.width(this.el)),h=i.DOM.height(this.el);"fitNoUpscale"===this.settings.imageScaleMethod?(s=t.naturalWidth,o=t.naturalHeight,s>r&&(e=r/s,s=Math.round(s*e),o=Math.round(o*e)),o>h&&(e=h/o,o=Math.round(o*e),s=Math.round(s*e))):(e=t.isLandscape?r/t.naturalWidth:h/t.naturalHeight,s=Math.round(t.naturalWidth*e),o=Math.round(t.naturalHeight*e),"zoom"===this.settings.imageScaleMethod?(e=1,h>o?e=h/o:r>s&&(e=r/s),1!==e&&(s=Math.round(s*e),o=Math.round(o*e))):"fit"===this.settings.imageScaleMethod&&(e=1,s>r?e=r/s:o>h&&(e=h/o),1!==e&&(s=Math.round(s*e),o=Math.round(o*e)))),n=Math.round((h-o)/2)+"px",a=Math.round((r-s)/2)+"px",i.DOM.setStyle(t,{position:"absolute",width:s,height:o,top:n,left:a,display:"block"})}},setContentLeftPosition:function(){var e,s,o;e=this.settings.target===t?i.DOM.windowWidth():i.DOM.width(this.settings.target),s=this.getItemEls(),o=0,this.settings.loop?o=-1*(e+this.settings.margin):this.currentCacheIndex===this.cache.images.length-1?o=(s.length-1)*(e+this.settings.margin)*-1:this.currentCacheIndex>0&&(o=-1*(e+this.settings.margin)),i.DOM.setStyle(this.contentEl,{left:o+"px"})},show:function(t){this.currentCacheIndex=t,this.resetPosition(),this.setImages(!1),i.DOM.show(this.el),i.Animation.resetTranslate(this.contentEl);var e,o,n=this.getItemEls();for(e=0,o=n.length;o>e;e++)i.Animation.resetTranslate(n[e]);i.Events.fire(this,{type:s.Carousel.EventTypes.onSlideByEnd,target:this,action:s.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(t){var e,i=this.getItemEls(),s=this.currentCacheIndex+1,o=this.currentCacheIndex-1;this.settings.loop?(s>this.cache.images.length-1&&(s=0),0>o&&(o=this.cache.images.length-1),
e=this.cache.getImages([o,this.currentCacheIndex,s]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[0],i[0])):1===i.length?t||(e=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(e[0],i[0])):2===i.length?0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[0],i[0])):0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2])):this.currentCacheIndex===this.cache.images.length-1?(e=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[0],i[0])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[0],i[0]))},addCacheImageToItemEl:function(t,e){i.DOM.removeClass(e,s.Carousel.CssClasses.itemError),i.DOM.addClass(e,s.Carousel.CssClasses.itemLoading),i.DOM.removeChildren(e),i.DOM.setStyle(t.imageEl,{display:"none"}),i.DOM.appendChild(t.imageEl,e),i.Animation.resetTranslate(t.imageEl),i.Events.add(t,s.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.add(t,s.Image.EventTypes.onError,this.imageErrorHandler),t.load()},slideCarousel:function(e,o,n){if(!this.isSliding){var a,r,h;if(a=this.settings.target===t?i.DOM.windowWidth()+this.settings.margin:i.DOM.width(this.settings.target)+this.settings.margin,n=i.coalesce(n,this.settings.slideSpeed),!(t.Math.abs(r)<1)){switch(o){case i.TouchElement.ActionTypes.swipeLeft:h=-1*a;break;case i.TouchElement.ActionTypes.swipeRight:h=a;break;default:r=e.x-this.touchStartPoint.x,h=t.Math.abs(r)>a/2?r>0?a:-1*a:0}0>h?this.lastSlideByAction=s.Carousel.SlideByAction.next:h>0?this.lastSlideByAction=s.Carousel.SlideByAction.previous:this.lastSlideByAction=s.Carousel.SlideByAction.current,this.settings.loop||(this.lastSlideByAction===s.Carousel.SlideByAction.previous&&0===this.currentCacheIndex||this.lastSlideByAction===s.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(h=0,this.lastSlideByAction=s.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(h,n)}}},moveCarousel:function(t){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(t.x-this.touchStartPoint.x)},getItemEls:function(){return i.DOM.find("."+s.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=t.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),i.Events.fire(this,{type:s.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){i.isNothing(this.slideshowTimeout)||(t.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,i.Events.fire(this,{type:s.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!i.isNothing(this.isSliding)){var t=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===s.Carousel.SlideByAction.next?this.currentCacheIndex=this.currentCacheIndex+1:this.lastSlideByAction===s.Carousel.SlideByAction.previous&&(this.currentCacheIndex=this.currentCacheIndex-1),this.settings.loop?(this.lastSlideByAction===s.Carousel.SlideByAction.next?i.DOM.appendChild(t[0],this.contentEl):this.lastSlideByAction===s.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl),this.currentCacheIndex<0?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0)):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===s.Carousel.SlideByAction.next?i.DOM.appendChild(t[0],this.contentEl):this.lastSlideByAction===s.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl):1===this.currentCacheIndex?this.lastSlideByAction===s.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===s.Carousel.SlideByAction.next&&i.DOM.appendChild(t[0],this.contentEl)),this.lastSlideByAction!==s.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),i.Events.fire(this,{type:s.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==s.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(e,s){switch(this.stopSlideshow(),e){case i.TouchElement.ActionTypes.touchStart:this.touchStartPoint=s,this.touchStartPosition={x:t.parseInt(i.DOM.getStyle(this.contentEl,"left"),0),y:t.parseInt(i.DOM.getStyle(this.contentEl,"top"),0)};break;case i.TouchElement.ActionTypes.touchMove:this.moveCarousel(s);break;case i.TouchElement.ActionTypes.touchMoveEnd:case i.TouchElement.ActionTypes.swipeLeft:case i.TouchElement.ActionTypes.swipeRight:this.slideCarousel(s,e);break;case i.TouchElement.ActionTypes.tap:break;case i.TouchElement.ActionTypes.doubleTap:}},onImageLoad:function(t){var e=t.target;i.isNothing(e.imageEl.parentNode)||(i.DOM.removeClass(e.imageEl.parentNode,s.Carousel.CssClasses.itemLoading),this.resetImagePosition(e.imageEl)),i.Events.remove(e,s.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(e,s.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(t){var e=t.target;i.isNothing(e.imageEl.parentNode)||(i.DOM.removeClass(e.imageEl.parentNode,s.Carousel.CssClasses.itemLoading),i.DOM.addClass(e.imageEl.parentNode,s.Carousel.CssClasses.itemError)),i.Events.remove(e,s.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(e,s.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var s=t.Code.PhotoSwipe;s.Carousel.CarouselClass=s.Carousel.CarouselClass.extend({getStartingPos:function(){var e=this.touchStartPosition;return i.isNothing(e)&&(e={x:t.parseInt(i.DOM.getStyle(this.contentEl,"left"),0),y:t.parseInt(i.DOM.getStyle(this.contentEl,"top"),0)}),e},doMoveCarousel:function(e){var s;i.Browser.isCSSTransformSupported?(s={},s[i.Animation._transitionPrefix+"Property"]="all",s[i.Animation._transitionPrefix+"Duration"]="",s[i.Animation._transitionPrefix+"TimingFunction"]="",s[i.Animation._transitionPrefix+"Delay"]="0",s[i.Animation._transformLabel]=i.Browser.is3dSupported?"translate3d("+e+"px, 0px, 0px)":"translate("+e+"px, 0px)",i.DOM.setStyle(this.contentEl,s)):i.isNothing(t.jQuery)||t.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+e+"px")},doSlideCarousel:function(e,s){var o,n;if(0>=s)return void this.slideByEndHandler();if(i.Browser.isCSSTransformSupported){if(n=i.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),0===n.indexOf("translate3d("+e))return void this.slideByEndHandler();if(0===n.indexOf("translate("+e))return void this.slideByEndHandler();i.Animation.slideBy(this.contentEl,e,0,s,this.slideByEndHandler,this.settings.slideTimingFunction)}else i.isNothing(t.jQuery)||(o={left:this.getStartingPos().x+e+"px"},"ease-out"===this.settings.animationTimingFunction&&(this.settings.animationTimingFunction="easeOutQuad"),i.isNothing(t.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),t.jQuery(this.contentEl).animate(o,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Toolbar");var s=t.Code.PhotoSwipe;s.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},s.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},s.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},s.Toolbar.getToolbar=function(){return'<div class="'+s.Toolbar.CssClasses.close+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.play+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.previous+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.next+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Toolbar");var s=t.Code.PhotoSwipe;s.Toolbar.ToolbarClass=e({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var t;this.clearTimeout(),this.removeEventHandlers(),i.Animation.stop(this.toolbarEl),i.Animation.stop(this.captionEl),i.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),i.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o){var n;this.settings=o,this.cache=e,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),n=s.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(n=n+" "+s.Toolbar.CssClasses.toolbarTop),this.toolbarEl=i.DOM.createElement("div",{"class":n},this.settings.getToolbar()),i.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===t?i.DOM.appendToBody(this.toolbarEl):i.DOM.appendChild(this.toolbarEl,this.settings.target),i.DOM.hide(this.toolbarEl),this.closeEl=i.DOM.find("."+s.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!i.isNothing(this.closeEl)&&i.DOM.hide(this.closeEl),this.playEl=i.DOM.find("."+s.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!i.isNothing(this.playEl)&&i.DOM.hide(this.playEl),this.nextEl=i.DOM.find("."+s.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=i.DOM.find("."+s.Toolbar.CssClasses.previous,this.toolbarEl)[0],n=s.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(n=n+" "+s.Toolbar.CssClasses.captionBottom),this.captionEl=i.DOM.createElement("div",{"class":n},""),i.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===t?i.DOM.appendToBody(this.captionEl):i.DOM.appendChild(this.captionEl,this.settings.target),i.DOM.hide(this.captionEl),this.captionContentEl=i.DOM.createElement("div",{"class":s.Toolbar.CssClasses.captionContent},""),i.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var e,s,o;this.settings.target===t?(this.settings.captionAndToolbarFlipPosition?(s=i.DOM.windowScrollTop(),o=i.DOM.windowScrollTop()+i.DOM.windowHeight()-i.DOM.height(this.captionEl)):(s=i.DOM.windowScrollTop()+i.DOM.windowHeight()-i.DOM.height(this.toolbarEl),o=i.DOM.windowScrollTop()),e=i.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(s="0",o=i.DOM.height(this.settings.target)-i.DOM.height(this.captionEl)):(s=i.DOM.height(this.settings.target)-i.DOM.height(this.toolbarEl),o=0),e=i.DOM.width(this.settings.target)),i.DOM.setStyle(this.toolbarEl,{top:s+"px",width:e}),i.DOM.setStyle(this.captionEl,{top:o+"px",width:e})},toggleVisibility:function(t){this.isVisible?this.fadeOut():this.show(t)},show:function(t){i.Animation.stop(this.toolbarEl),i.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(t),i.Events.fire(this,{type:s.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(t),this.showCaption(),this.isVisible=!0,this.setTimeout(),i.Events.fire(this,{type:s.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=t.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){i.isNothing(this.timeout)||(t.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),i.Events.fire(this,{type:s.Toolbar.EventTypes.onBeforeHide,target:this}),i.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),i.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){i.Browser.isTouchSupported&&(i.Browser.blackberry||i.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),i.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),i.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),i.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){i.Browser.isTouchSupported&&(i.Browser.blackberry||i.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),i.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),i.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),i.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(t){this.clearTimeout();var e;t.target===this.nextEl||i.DOM.isChildOf(t.target,this.nextEl)?e=s.Toolbar.ToolbarAction.next:t.target===this.previousEl||i.DOM.isChildOf(t.target,this.previousEl)?e=s.Toolbar.ToolbarAction.previous:t.target===this.closeEl||i.DOM.isChildOf(t.target,this.closeEl)?e=s.Toolbar.ToolbarAction.close:(t.target===this.playEl||i.DOM.isChildOf(t.target,this.playEl))&&(e=s.Toolbar.ToolbarAction.play),this.setTimeout(),i.isNothing(e)&&(e=s.Toolbar.ToolbarAction.none),i.Events.fire(this,{type:s.Toolbar.EventTypes.onTap,target:this,action:e,tapTarget:t.target})},setCaption:function(t){i.DOM.removeChildren(this.captionContentEl),this.currentCaption=i.coalesce(this.cache.images[t].caption," "),i.isObject(this.currentCaption)?i.DOM.appendChild(this.currentCaption,this.captionContentEl):(""===this.currentCaption&&(this.currentCaption=" "),i.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption=" "===this.currentCaption?"":this.currentCaption,this.resetPosition()},showToolbar:function(){i.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),i.DOM.show(this.toolbarEl)},showCaption:function(){return(""===this.currentCaption||this.captionContentEl.childNodes.length<1)&&!this.settings.captionAndToolbarShowEmptyCaptions?void i.DOM.hide(this.captionEl):(i.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),void i.DOM.show(this.captionEl))},setToolbarStatus:function(t){this.settings.loop||(i.DOM.removeClass(this.previousEl,s.Toolbar.CssClasses.previousDisabled),i.DOM.removeClass(this.nextEl,s.Toolbar.CssClasses.nextDisabled),t>0&&t<this.cache.images.length-1||(0===t&&(i.isNothing(this.previousEl)||i.DOM.addClass(this.previousEl,s.Toolbar.CssClasses.previousDisabled)),t===this.cache.images.length-1&&(i.isNothing(this.nextEl)||i.DOM.addClass(this.nextEl,s.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){i.DOM.hide(this.toolbarEl),i.DOM.hide(this.captionEl),i.Events.fire(this,{type:s.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(t){t.preventDefault(),i.Events.remove(this.toolbarEl,"click",this.clickHandler),this.handleTap(t)},onTouchMove:function(t){t.preventDefault()},onClick:function(t){t.preventDefault(),this.handleTap(t)}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.UILayer");var s=t.Code.PhotoSwipe;s.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.UILayer");var s=t.Code.PhotoSwipe;s.UILayer.UILayerClass=i.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var t;this.removeEventHandlers(),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e){this.settings=e,this.el=i.DOM.createElement("div",{"class":s.UILayer.CssClasses.uiLayer},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),i.DOM.hide(this.el),this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:i.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===t?i.DOM.setStyle(this.el,{top:i.DOM.windowScrollTop()+"px",width:i.DOM.windowWidth(),height:i.DOM.windowHeight()}):i.DOM.setStyle(this.el,{top:"0px",width:i.DOM.width(this.settings.target),height:i.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),i.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var s=t.Code.PhotoSwipe;s.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},s.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util),function(t,e,i){i.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var s=t.Code.PhotoSwipe;s.ZoomPanRotate.ZoomPanRotateClass=e({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var t;i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o,n){var a,r,h,l;this.settings=e,this.settings.target===t?(a=document.body,r=i.DOM.windowWidth(),h=i.DOM.windowHeight(),l=i.DOM.windowScrollTop()+"px"):(a=this.settings.target,r=i.DOM.width(a),h=i.DOM.height(a),l="0px"),this.imageEl=o.imageEl.cloneNode(!1),i.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=i.DOM.createElement("div",{"class":s.ZoomPanRotate.CssClasses.zoomPanRotate},""),i.DOM.setStyle(this.el,{left:0,top:l,position:"absolute",width:r,height:h,zIndex:this.settings.zIndex,display:"block"}),i.DOM.insertBefore(this.el,n.el,a),i.Browser.iOS?(this.containerEl=i.DOM.createElement("div","",""),i.DOM.setStyle(this.containerEl,{left:0,top:0,width:r,height:h,position:"absolute",zIndex:1}),i.DOM.appendChild(this.imageEl,this.containerEl),i.DOM.appendChild(this.containerEl,this.el),i.Animation.resetTranslate(this.containerEl),i.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(i.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var e,s=i.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);i.isNothing(s)||(e=s.match(/translate\((.*?)\)/),i.isNothing(e)||(e=e[1].split(", "),this.transformSettings.startingTranslateX=t.parseInt(e[0],10),this.transformSettings.startingTranslateY=t.parseInt(e[1],10)))},getScale:function(t){var e=this.transformSettings.startingScale*t;return 0!==this.settings.minUserZoom&&e<this.settings.minUserZoom?e=this.settings.minUserZoom:0!==this.settings.maxUserZoom&&e>this.settings.maxUserZoom&&(e=this.settings.maxUserZoom),e},setStartingScaleAndRotation:function(t,e){this.transformSettings.startingScale=this.getScale(t),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+e)%360},zoomRotate:function(t,e){this.transformSettings.scale=this.getScale(t),this.transformSettings.rotation=this.transformSettings.startingRotation+e,this.applyTransform()},panStart:function(t){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:t.x,y:t.y}},pan:function(t){var e=t.x-this.panStartingPoint.x,i=t.y-this.panStartingPoint.y,s=e/this.transformSettings.scale,o=i/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+s,this.transformSettings.translateY=this.transformSettings.startingTranslateY+o,this.applyTransform()},zoomAndPanToPoint:function(e,s){if(this.settings.target===t){this.panStart({x:i.DOM.windowWidth()/2,y:i.DOM.windowHeight()/2});var o=s.x-this.panStartingPoint.x,n=s.y-this.panStartingPoint.y,a=o/this.transformSettings.scale,r=n/this.transformSettings.scale;this.transformSettings.translateX=-1*(this.transformSettings.startingTranslateX+a),this.transformSettings.translateY=-1*(this.transformSettings.startingTranslateY+r)}this.setStartingScaleAndRotation(e,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var e=this.transformSettings.rotation%360,o=t.parseInt(this.transformSettings.translateX,10),n=t.parseInt(this.transformSettings.translateY,10),a="scale("+this.transformSettings.scale+") rotate("+e+"deg) translate("+o+"px, "+n+"px)";i.DOM.setStyle(this.transformEl,{webkitTransform:a,MozTransform:a,msTransform:a,transform:a}),i.Events.fire(this,{target:this,type:s.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:e,translateX:o,translateY:n})}})}(window,window.klass,window.Code.Util),function(t,e){e.registerNamespace("Code.PhotoSwipe");var i=t.Code.PhotoSwipe;i.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},i.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},i.instances=[],i.activeInstances=[],i.setActivateInstance=function(t){var s=e.arrayIndexOf(t.settings.target,i.activeInstances,"target");if(s>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";i.activeInstances.push({target:t.settings.target,instance:t})},i.unsetActivateInstance=function(t){var s=e.arrayIndexOf(t,i.activeInstances,"instance");i.activeInstances.splice(s,1)},i.attach=function(t,s,o){var n,a,r,h;for(r=i.createInstance(t,s,o),n=0,a=t.length;a>n;n++)h=t[n],e.isNothing(h.nodeType)||1===h.nodeType&&(h.__photoSwipeClickHandler=i.onTriggerElementClick.bind(r),e.Events.remove(h,"click",h.__photoSwipeClickHandler),e.Events.add(h,"click",h.__photoSwipeClickHandler));return r},t.jQuery&&(t.jQuery.fn.photoSwipe=function(t,e){return i.attach(this,t,e)}),i.detatch=function(t){var s,o,n;for(s=0,o=t.originalImages.length;o>s;s++)n=t.originalImages[s],e.isNothing(n.nodeType)||1===n.nodeType&&(e.Events.remove(n,"click",n.__photoSwipeClickHandler),delete n.__photoSwipeClickHandler);i.disposeInstance(t)},i.createInstance=function(t,s,o){var n;if(e.isNothing(t))throw"Code.PhotoSwipe.attach: No images passed.";if(!e.isLikeArray(t))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(t.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";if(s=e.coalesce(s,{}),n=i.getInstance(o),!e.isNothing(n))throw'Code.PhotoSwipe.createInstance: Instance with id "'+o+' already exists."';return n=new i.PhotoSwipeClass(t,s,o),i.instances.push(n),n},i.disposeInstance=function(t){var e=i.getInstanceIndex(t);if(0>e)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";t.dispose(),i.instances.splice(e,1),t=null},i.onTriggerElementClick=function(t){t.preventDefault();var e=this;e.show(t.currentTarget)},i.getInstance=function(t){var e,s,o;for(e=0,s=i.instances.length;s>e;e++)if(o=i.instances[e],o.id===t)return o;return null},i.getInstanceIndex=function(t){var e,s,o=-1;for(e=0,s=i.instances.length;s>e;e++)if(i.instances[e]===t){o=e;break}return o}}(window,window.Code.Util),function(t,e,i,s,o,n,a,r,h){i.registerNamespace("Code.PhotoSwipe");var l=t.Code.PhotoSwipe;l.PhotoSwipeClass=e({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var t;i.Events.remove(this,l.EventTypes.onBeforeShow),i.Events.remove(this,l.EventTypes.onShow),i.Events.remove(this,l.EventTypes.onBeforeHide),i.Events.remove(this,l.EventTypes.onHide),i.Events.remove(this,l.EventTypes.onDisplayImage),i.Events.remove(this,l.EventTypes.onResetPosition),i.Events.remove(this,l.EventTypes.onSlideshowStart),i.Events.remove(this,l.EventTypes.onSlideshowStop),i.Events.remove(this,l.EventTypes.onTouch),i.Events.remove(this,l.EventTypes.onBeforeCaptionAndToolbarShow),i.Events.remove(this,l.EventTypes.onCaptionAndToolbarShow),i.Events.remove(this,l.EventTypes.onBeforeCaptionAndToolbarHide),i.Events.remove(this,l.EventTypes.onCaptionAndToolbarHide),i.Events.remove(this,l.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),i.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),i.isNothing(this.carousel)||this.carousel.dispose(),i.isNothing(this.uiLayer)||this.uiLayer.dispose(),i.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),i.isNothing(this.cache)||this.cache.dispose();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o,n){var a;i.isNothing(n)?this.id="PhotoSwipe"+(new Date).getTime().toString():this.id=n,this.originalImages=e,i.Browser.android&&!i.Browser.firefox&&t.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=i.objectHasProperty(t,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!i.isNothing(t.jQuery)&&!i.isNothing(t.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:t,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:l.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:l.Cache.Functions.getImageSource,getImageCaption:l.Cache.Functions.getImageCaption,getImageMetaData:l.Cache.Functions.getImageMetaData,cacheMode:l.Cache.Mode.normal},i.extend(this.settings,o),this.settings.target!==t&&(a=i.DOM.getStyle(this.settings.target,"position"),"relative"===a&&"absolute"===a||i.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==t?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new s.CacheClass(e,this.settings)},show:function(e){var s,o;if(this._isResettingPosition=!1,this.backButtonClicked=!1,i.isNumber(e))this.currentIndex=e;else for(this.currentIndex=-1,s=0,o=this.originalImages.length;o>s;s++)if(this.originalImages[s]===e){this.currentIndex=s;break}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),l.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===t?i.DOM.addClass(t.document.body,l.CssClasses.buildingBody):i.DOM.addClass(this.settings.target,l.CssClasses.buildingBody),this.createComponents(),i.Events.fire(this,{type:l.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:i.DOM.windowWidth(),height:i.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new o.DocumentOverlayClass(this.settings),this.carousel=new n.CarouselClass(this.cache,this.settings),this.uiLayer=new r.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new a.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var t=this.getWindowDimensions();(i.isNothing(this.windowDimensions)||t.width!==this.windowDimensions.width||t.height!==this.windowDimensions.height)&&(this._isResettingPosition=!0,this.windowDimensions=t,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),i.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,i.Events.fire(this,{type:l.EventTypes.onResetPosition,target:this}))}},addEventHandler:function(t,e){i.Events.add(this,t,e)},addEventHandlers:function(){if(i.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),
this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),i.Browser.android)this.orientationEventName="resize";else if(i.Browser.iOS&&!i.Browser.safari)i.Events.add(t.document.body,"orientationchange",this.windowOrientationChangeHandler);else{var e=!i.isNothing(t.onorientationchange);this.orientationEventName=e?"orientationchange":"resize"}i.isNothing(this.orientationEventName)||i.Events.add(t,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===t&&i.Events.add(t,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&i.Events.add(t.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?t.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),t.location.hash=this.currentHistoryHashValue),i.Events.add(t,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&i.Events.add(t,"mousewheel",this.mouseWheelHandler),i.Events.add(this.uiLayer,i.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),i.Events.add(this.carousel,n.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),i.Events.add(this.carousel,n.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),i.Events.add(this.carousel,n.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),i.isNothing(this.toolbar)||(i.Events.add(this.toolbar,a.EventTypes.onTap,this.toolbarTapHandler),i.Events.add(this.toolbar,a.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),i.Events.add(this.toolbar,a.EventTypes.onShow,this.toolbarShowHandler),i.Events.add(this.toolbar,a.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),i.Events.add(this.toolbar,a.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){i.Browser.iOS&&!i.Browser.safari&&i.Events.remove(t.document.body,"orientationchange",this.windowOrientationChangeHandler),i.isNothing(this.orientationEventName)||i.Events.remove(t,this.orientationEventName,this.windowOrientationChangeHandler),i.Events.remove(t,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&i.Events.remove(t.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&i.Events.remove(t,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&i.Events.remove(t,"mousewheel",this.mouseWheelHandler),i.isNothing(this.uiLayer)||i.Events.remove(this.uiLayer,i.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),i.isNothing(this.toolbar)||(i.Events.remove(this.carousel,n.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),i.Events.remove(this.carousel,n.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),i.Events.remove(this.carousel,n.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),i.isNothing(this.toolbar)||(i.Events.remove(this.toolbar,a.EventTypes.onTap,this.toolbarTapHandler),i.Events.remove(this.toolbar,a.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),i.Events.remove(this.toolbar,a.EventTypes.onShow,this.toolbarShowHandler),i.Events.remove(this.toolbar,a.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),i.Events.remove(this.toolbar,a.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(i.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";i.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),i.Events.fire(this,{type:l.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,i.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,i.DOM.removeClass(t.document.body,l.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,l.unsetActivateInstance(this),i.Events.fire(this,{type:l.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||t.history.back())},play:function(){this.isZoomActive()||this.settings.preventSlideshow||i.isNothing(this.carousel)||(!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||i.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(i.Events.fire(this,l.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new h.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,i.Events.add(this.zoomPanRotate,l.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),i.Events.fire(this,l.EventTypes.onZoomPanRotateShow),!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){i.isNothing(this.zoomPanRotate)||(i.Events.fire(this,l.EventTypes.onBeforeZoomPanRotateHide),i.Events.remove(this.zoomPanRotate,l.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,i.Events.fire(this,l.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var t,e;if(i.Browser.msie){if(t=document.createElement("div"),i.isNothing(t.style.msTransform))return!1}else if(!i.Browser.isCSSTransformSupported)return!1;return this.settings.allowUserZoom?this.carousel.isSliding?!1:(e=this.cache.images[this.currentIndex],i.isNothing(e)?!1:!e.isLoading):!1},isZoomActive:function(){return!i.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){t.setTimeout(function(){var e=this.settings.target===t?t.document.body:this.settings.target;i.DOM.removeClass(e,l.CssClasses.buildingBody),i.DOM.addClass(e,l.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():i.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),i.Events.fire(this,{type:l.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&i.Browser.iOS&&!i.Browser.safari&&(i.isNothing(this._uiWebViewResetPositionTimeout)||t.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=t.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){i.isNothing(this._uiWebViewResetPositionTimeout)||t.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){var e="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);t.location.hash!==e&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(t){37===t.keyCode?(t.preventDefault(),this.previous()):39===t.keyCode?(t.preventDefault(),this.next()):38===t.keyCode||40===t.keyCode?t.preventDefault():27===t.keyCode?(t.preventDefault(),this.hide()):32===t.keyCode?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),t.preventDefault()):13===t.keyCode&&(t.preventDefault(),this.play())},onUILayerTouch:function(e){if(this.isZoomActive())switch(e.action){case i.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(e.scale,this.settings.allowRotationOnUserZoom?e.rotation:0);break;case i.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(e.scale,this.settings.allowRotationOnUserZoom?e.rotation:0);break;case i.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(e.point);break;case i.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(e.point);break;case i.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case i.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case i.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(e.action){case i.TouchElement.ActionTypes.touchMove:case i.TouchElement.ActionTypes.swipeLeft:case i.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(e.action,e.point);break;case i.TouchElement.ActionTypes.touchStart:case i.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(e.action,e.point);break;case i.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case i.TouchElement.ActionTypes.doubleTap:this.settings.target===t&&(e.point.x-=i.DOM.windowScrollLeft(),e.point.y-=i.DOM.windowScrollTop());var s=this.cache.images[this.currentIndex].imageEl,o=t.parseInt(i.DOM.getStyle(s,"top"),10),n=t.parseInt(i.DOM.getStyle(s,"left"),10),a=n+i.DOM.width(s),r=o+i.DOM.height(s);e.point.x<n?e.point.x=n:e.point.x>a&&(e.point.x=a),e.point.y<o?e.point.y=o:e.point.y>r&&(e.point.y=r),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,e.point);break;case i.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}i.Events.fire(this,{type:l.EventTypes.onTouch,target:this,point:e.point,action:e.action})},onCarouselSlideByEnd:function(t){this.currentIndex=t.cacheIndex,i.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),i.Events.fire(this,{type:l.EventTypes.onDisplayImage,target:this,action:t.action,index:t.cacheIndex})},onToolbarTap:function(t){switch(t.action){case a.ToolbarAction.next:this.next();break;case a.ToolbarAction.previous:this.previous();break;case a.ToolbarAction.close:this.hide();break;case a.ToolbarAction.play:this.play()}i.Events.fire(this,{type:l.EventTypes.onToolbarTap,target:this,toolbarAction:t.action,tapTarget:t.tapTarget})},onMouseWheel:function(t){var e=i.Events.getWheelDelta(t),s=t.timeStamp-(this.mouseWheelStartTime||0);s<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=t.timeStamp,this.settings.invertMouseWheel&&(e=-1*e),0>e?this.next():e>0&&this.previous())},onCarouselSlideshowStart:function(){i.Events.fire(this,{type:l.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){i.Events.fire(this,{type:l.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){i.Events.fire(this,{type:l.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){i.Events.fire(this,{type:l.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){i.Events.fire(this,{type:l.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){i.Events.fire(this,{type:l.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(t){i.Events.fire(this,{target:this,type:l.EventTypes.onZoomPanRotateTransform,scale:t.scale,rotation:t.rotation,rotationDegs:t.rotationDegs,translateX:t.translateX,translateY:t.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate);